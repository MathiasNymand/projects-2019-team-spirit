{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Model Project"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 64,
   "metadata": {},
   "outputs": [],
   "source": [
    "## Importing packages \n",
    "\n",
    "import numpy as np\n",
    "from scipy import linalg\n",
    "from scipy import optimize\n",
    "import sympy as sm\n",
    "sm.init_printing(use_unicode=True)\n",
    "import matplotlib.pyplot as plt\n",
    "import math\n",
    "import ipywidgets as widgets\n",
    "import time\n",
    "%matplotlib inline\n",
    "import matplotlib.pyplot as plt\n",
    "import ipywidgets as widgets"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 65,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Running python file to define variables\n",
    "exec(open(\"Def_variables.py\").read())"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## The Green Solow Model"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Our assignment builds on the original Solow model that was presented by Solow and Swan (1956). The standard Solow model is given by these equations:  \n",
    "$Q=F(K,BL)=K^\\alpha BL^{1-\\alpha},$ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;   $1>\\alpha>0$    \n",
    "$\\dot{K}=sY-\\delta K$  \n",
    "$\\dot{L}=nL \\Rightarrow L=L_0 e^{nt} $  \n",
    "$\\dot{B}=g_B B \\Rightarrow B=B_0 e^{g_Bt},$ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $1>g_B>0$\n",
    "\n",
    "The first equation shows a simple Cobb-Douglas production function where the production of gross output, Q, is made through Capital, K, and effective labour, BL. It can be shown that the production function exhibits constant return to scale.  \n",
    "The second equation is describing the evolution of capital, where, s, is a fixed savings rate of net output, Y. From equation 2 we see that the capital is assumed to depreciate with a constant rate, $\\delta$.  \n",
    "The third equation presents the evolution of workers over time. We notice that the evoulution is given by a constant growth rate, n. \n",
    "Lastly, we see that the technological progress in the production of output is given by the exogenous growth rate, $g_B$.\n",
    "\n",
    "In this assignment we will be working with an exstention of the original Solow model. Namely, we will work with the Green Solow model developed by William A. Brock and M. Scott Taylor (2004). In their model they add a function describing total emissions, E, given by:  \n",
    "$E=\\Omega Q-\\Omega A(Q,R)$  \n",
    "This simply shows that total emissions is given by the amount of pullution produced minus the amount of pollution abated.  \n",
    "$\\Omega$ is the fraction of pollution arising from the production of gross output, Q. It is important to notice that it is assumed that every unit of output generates the same fraction of pollution. Further, the equation shows that abatement exists in the economy. $(A(Q,R))$. The abatement has a negative effect on the total amount of emissions. Hence, abatement reduces the amount of pollution released into the atmosphere.\n",
    "\n",
    "In the Green Solow model it is assumed that the abatement function is a concave function that is increasing with gross output, Q, and the economy's effort at abatement, R. Hence, abatement has a diminishing effect on total emissions.\n",
    "\n",
    "When considering the Green Solow model there must be a lower amount available for consumption and investment due to the inclusion of abatement. We define this net output (income) as Y:  \n",
    "$Y=Q-R=(1-\\theta)Q$  \n",
    "We can rewrite this in order to understand how emissions are being affected in the Green Solow model.  \n",
    "$E=\\Omega (Q-A(Q,R))$  \n",
    "$E=\\Omega Q(1-A(1,\\frac{R}{Q})$  \n",
    "$E=\\Omega Q \\alpha(\\theta),$ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $\\theta \\equiv \\frac{R}{Q}$ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $\\alpha(\\theta) \\equiv 1-A(1,\\theta)$\n",
    "\n",
    "We notice that the emissions are affected by the scale of economic activity, Q. Further, we notice that the abatement intensity, $\\theta$ is assumed constant. There are more underlying mechanism in the Green Solow model such as the development in the fraction $\\Omega$ that we won't go into detail with due to the focus of this assignment.\n",
    "\n",
    "We are able to derive the model in output per effective worker since the production function has constant returns to scale. This implies that:  \n",
    "$Q=K^\\alpha (BL)^{1-\\alpha} \\Rightarrow q=k^\\alpha$ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $q\\equiv \\frac{Q}{BL},$ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $k\\equiv \\frac{K}{BL}$\n",
    "\n",
    "Using the above definitons we are now able to calculate the transition equation for capital per effective worker. When using the second equation and **the definitons just given** we get the following transition equation for capital per effective worker:  \n",
    "$\\dot{k}=s(1-\\theta)k^\\alpha-k(\\delta+g_B+n)$\n",
    "\n",
    "It can be shown that the growth rate for total emissions is given by:  \n",
    "$\\frac{\\dot{E}}{E}=g_E+\\alpha \\frac{\\dot{k}}{k},$ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $g_E\\equiv g_B+n-g_A$\n",
    "\n",
    "When substituting for $\\frac{\\dot{k}}{k}$ we get:  \n",
    "$\\frac{\\dot{E}}{E}=\\alpha s(1-\\theta)k^{\\alpha-1}-[\\alpha(\\delta+g_B+n)-g_E]$\n",
    "\n",
    "When considering this equation we notice that the emissions will peak ($\\dot{E}=0$) when $\\alpha s(1-\\theta)k^{\\alpha-1}=[\\alpha(\\delta+g_B+n)-g_E]$"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 1. Steady State of The Green Solow Model\n",
    "\n",
    "Firstly we want to find the steady state of the Green Solow Model. In steady state capital does not change over time meaning that $\\dot{k}$ is equal to zero. We do this by setting the transition equation (as it is stated above) equal to zero and solving for capital, k."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 66,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/latex": [
       "$$\\left [ \\left(\\frac{s \\left(- \\theta + 1\\right)}{\\delta + g_{b} + n}\\right)^{- \\frac{1}{\\alpha - 1}}\\right ]$$"
      ],
      "text/plain": [
       "⎡              -1  ⎤\n",
       "⎢             ─────⎥\n",
       "⎢             α - 1⎥\n",
       "⎢⎛ s⋅(-θ + 1)⎞     ⎥\n",
       "⎢⎜───────────⎟     ⎥\n",
       "⎣⎝δ + g_b + n⎠     ⎦"
      ]
     },
     "execution_count": 66,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Stating the transition equation and setting it equal to zero\n",
    "f=k**alpha\n",
    "tc=sm.Eq(0,(s*(1-theta)*k**alpha-(delta+g_b+n)*k))\n",
    "\n",
    "# Solving the transition equation (tc) for k\n",
    "tcc=sm.solve(tc,k)\n",
    "tcc\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 1.1  Analytical solution\n",
    "By stating the parameters and some realistic examples of parameter values we can find a numerical value for capital i the steady state."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 67,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/latex": [
       "$$\\left [ 6.261568722311015\\right ]$$"
      ],
      "text/plain": [
       "[6.261568722311015]"
      ]
     },
     "execution_count": 67,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Converting our tcc sympy function into a lambda function, making it possible to calculate a numerical value solution.\n",
    "tc_func = sm.lambdify((s,g_b,n,delta,alpha,theta),tcc)\n",
    "    \n",
    "# Adding numerical values to our parameters\n",
    "tc_func(0.25,0.015,0.01,0.035,0.25,0.05)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "In steady state capital is equal to 6.26."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 1.2 Numerical Solution\n",
    "\n",
    "We also try to solve for capital in the steady state analytically."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 68,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAANMAAAASCAYAAADBs+vIAAAABHNCSVQICAgIfAhkiAAABklJREFUaIHt2musXUUVB/BfCwitEOXZRnmItLxaQyS8H3JaFQXkjX4gAhqJhBhegfAKhBJFBQxCikoMqIkkfFAshPIOKRQrBI0agiBU6cESKNBCoTxL4fphzek9d9+979l7n30vCTn/5GROZtaatfaaNTNr1gwDDDDAuOJg3IoX8V4q78PhJfm3xKlYgP/gHbyOP+N7mNyQ7BMwHw/jDQzh5h66tRNd3m9FQ3rBEan9efH9z+IP2D+H9jtj6NT5fZDhqWrjumNyJR7A8sTzKv6By1KfeagzLnV4tsVv8IIYkzauxeYNymgr6S8b5jBfgh9iJRYKp9kKX0QLd/UQDt/ErxLvIvwP03AcbsRhiWaoT9mXYA+8KZx21xK6EU50bU79mwX0VfW6EudjFW5LfDNwNI7HyUYO4j9xeYHsgzEXd2fqq9q47picg7/jfryMT2I/zMP30//lGZ4641KVZyf8Bdvgdvwb++AsfB0HCvv3qxfV/QXDxrwfm+W0b1RS+FwcafRqN10M4pBwqn5lz8FMTBJOXXalafeg6Uev6WIXWSEGOqvvkNilyuKRxHNUpr6qjeuMCWxSoNcVieeXOW11xqUqz72J5oxM/TWp/oaG9Gqr5i8IIz+Lt7B1VeYKuFh8xPyGZbc0b5w6eu2b9Li9oP0NrCnZ1+zU1/PYoCQP+TZukp5Y4TuLzFhoKTcuVXg+n9qXGb04bCZ2jLfELtqvXm0l/aU7zDsAO+KPeE3E/LPxLh4TK2QTeD+V6z4C2R1sjG9je2H0x7HY6HNJHb2WYq0IObYSIV4HXxKDfVtJPU9L5U05uo2FPBs3SU/scoTtJhpzU3kfPsy0rcESHCpC0AcakFfKX7on096pfEnEyF/IdLhYHOBe6UOpDcV5Ae6ZYNndmI7fZ+qW4bt4qE+9XsUFItx4UkycVSLGP0qs5KfpjSliAD8UZ5qyKLJxv/TnYVN8CnvhIOFUP62gW1PYJZXPFLQvFZNpZ81MprL+sh4/EdveuqTMl4XxZgkjD+HBPpX6WernznGQ3VJu275MrGzTMFXsNDcIp31bhC9N6HWMmFjd2Z+lOLGHfh2ckngWlqTvoMjG/dKvMPJb7hY27IWW5sO8X6f2UwvaO+e5ixrQq4q/rMdVhlOwWYIpImMzJD+1WwZnJv6nsMU4yG6pPmjd6DjVggb0Ol9MwGtEfD8Vexo+NF9VQp8lifbIXoRdGMvGTdATTnUsnhYp6T170LdM/GT6cWq/sGG9upHnL+txkeHVMw83pvazagj+QeL9l9gyx0N2S3/GmZH4u9OpdfTq6PGnHPqpIpnwgZhkRdg99bFc+cRDLxv3S5/FDuJu54kedC3NT6arU/u5Be3Xp/bTG9arG6P8pTsT8nQqVxcwv5bKKRWFni0+7gmRmsy7GB0v2VXwciq7M0B19PpGKhfl0L8tEheTxR1VEaomHsrYuB/6PDwnzoSzRKJlItEZl50L2memsuhM1QRG+Uv3ZFosQpOZ+EQO8+xUtisIvAA/F5eSc7oUyGI8ZFdFJ1TrvgOqo9fGqSxKpXfq1xa0b4KTREx+U7G661HWxnXpx8JnUlkl09gEOgvVofJT4weK1xqPjqMOef4yAjeLretHmfqvisFdjU931e8kbpHzLlQvTX39Tbl4vKrsLFp6b9uzCnTZQYRyQ+LOpR+9vmX4qclnMzyHJZ53FD/FOSnx3zHGd3RQ1cZV6XeVHwJONnzIX9Kjj5bmwzzqXdpWlVHJXyZliLYRxpkh3i89lhiPTYwnivdlHbRT+45Grs6n4HdixZovnmNk0U40dWUTGbNj0v/p+JpYKR5OdStFSreDeeJQukikNteIBeEIsSPcleR17xpV9ZosBvorqf8FYmLtJkLASSLMui7HJpKMg0QafawJVdXGdcbkbHE+WYz/ivPBNBwiznwrRIbzyUw/VcelDk/2OdFT4sJ8jgjvDjD6OdFE+MsIbCFm97JEtCopu18ObVs41Ocy9fP0frj5YJ+yy8hpZ+gPwS3iHddqcVn5irj7OdnoxaWuXhsJR3xUvHhYJ8KphSI0KcJuyice5qlm46r0RBj7CxESrkzf8Tr+mvor2t16yWo3xLMdfiveG64V57jrGtSrrr8MMMAAAwwwwAADDPDxwf8BLp3dyyYWW24AAAAASUVORK5CYII=\n",
      "text/latex": [
       "$$6.261568722311015$$"
      ],
      "text/plain": [
       "6.261568722311015"
      ]
     },
     "execution_count": 68,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Running python file to define parameter values\n",
    "exec(open(\"Def_values.py\").read())\n",
    "\n",
    "# Defining our steady state as a lambda function\n",
    "obj_kss = lambda k: 0 - (s*(1-theta)*k**alpha-(delta+g_b+n)*k)\n",
    "\n",
    "# optimize.newton uses a numerical solution to find a numerical value solution to our steady state\n",
    "result = optimize.newton(obj_kss,x0=1)\n",
    "result"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The numerical solution is as expected the same as the analytical.\n",
    "\n",
    "### 1.3 Transition Diagram\n",
    "\n",
    "We now want to illustrate steady state in a transition diagram. The diagram shows how capital evolves over time and reaches steady state at the intersect.\n",
    "\n",
    "First we define the functions in the transitions diagram: investment pr. worker and the break even functions."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 69,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Defining the investment per worker function, which calculates the saving/investment locus.\n",
    "def invest_per_work2(k, theta,alpha,s):\n",
    "    return (s*(1-theta)*k**alpha)\n",
    "\n",
    "# The break even equation does not depend on any of the parameters we have set for our widget. \n",
    "# The point where the two functions intersect is the steady state value of k\n",
    "def break_even(k):\n",
    "    return (delta+g_b+n)*k"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 70,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Defining the k values of the function\n",
    "x_vec = np.linspace(0,50,50)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The following code set up the structure of the diagram."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 71,
   "metadata": {},
   "outputs": [],
   "source": [
    "def transition_diagram2(theta,alpha,s):\n",
    "    \n",
    "    fig = plt.figure(figsize=(7,4)) # create the figure\n",
    "    plt.xlabel('k') # label x-axis\n",
    "    investment=invest_per_work2(x_vec,theta,alpha,s) # calculate the investments per worker using the function\n",
    "    break_even_cap=break_even(x_vec) # calculate the break even equation for the x-values\n",
    "    plt.title('Green solow transition diagram') #Title\n",
    "    ax = fig.add_subplot(1,1,1) # Include many plots \n",
    "    ax.plot(break_even_cap, label='$(\\delta+g_B+n)\\cdot k$'); # plot and label\n",
    "    ax.plot(investment, label='$s \\cdot (1-\\\\theta)\\cdot k^\\\\alpha $'); # plot and label\n",
    "    ax.set_xlim([0,50]) # fixed x range\n",
    "    ax.set_yticklabels([]) #remove y-labes\n",
    "    plt.legend() # plot the labels in the legend\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We add sliders to our diagram, so it is clear what impact the abatement intensity, savings and $\\alpha$ has on the steady state."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 72,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "0715f66ff2c64fe6bced686081d129ca",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "interactive(children=(FloatSlider(value=0.05, description='$Theta$', max=1.0, step=0.01), FloatSlider(value=0.…"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "# Widgets - all our widgets have the same min and max. Starting values differ according to the default values stated in \n",
    "# our model description earlier, they can also be found in the .py file with values.\n",
    "\n",
    "# Call diagram with widgets\n",
    "widgets.interact(transition_diagram2,\n",
    "    \n",
    "    # widgets for all the inputs in the function transition_diagram2             \n",
    "    theta=widgets.FloatSlider(description=\"$Theta$\", min=0, max=1, step=0.01, value=0.05),\n",
    "    alpha=widgets.FloatSlider(description=\"$Alpha$\", min=0, max=1, step=0.01, value=0.25),\n",
    "    s=widgets.FloatSlider(description=\"$s$\", min=0, max=1, step=0.01, value=0.25),\n",
    "    \n",
    ");"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Comment on the figure!!"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## 2. Emissions in the Green Solow Model\n",
    "\n",
    "### 2.1 Peak of Emmisions\n",
    "The Green Solow Model also predicts when the peak of emission occur depending on the abatement intensity, $\\theta$. In the following,  we solve for k, at the peak of emissions like we did with the transitions equation. We use the emission euqation (...) for this. As emissions over time does not change at the peak we set $\\dot{E}$ equal zero.\n",
    "We choose only to use an analytical solution when solving for k at the peak of emissions."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 73,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Running python file defining variables to remove the previously set parameter values\n",
    "exec(open(\"Def_variables.py\").read())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 74,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/latex": [
       "$$\\left [ \\left(\\frac{- \\alpha \\delta - \\alpha g_{b} - \\alpha n - g_{a} + g_{b} + n}{\\alpha s \\left(\\theta - 1\\right)}\\right)^{\\frac{1}{\\alpha - 1}}\\right ]$$"
      ],
      "text/plain": [
       "⎡                                     1  ⎤\n",
       "⎢                                   ─────⎥\n",
       "⎢                                   α - 1⎥\n",
       "⎢⎛-α⋅δ - α⋅g_b - α⋅n - gₐ + g_b + n⎞     ⎥\n",
       "⎢⎜─────────────────────────────────⎟     ⎥\n",
       "⎣⎝           α⋅s⋅(θ - 1)           ⎠     ⎦"
      ]
     },
     "execution_count": 74,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Stating the emision equation and setting it equal to zero\n",
    "max_emis=sm.Eq(0,(alpha*s*(1-theta)*k**(alpha-1)-(alpha*(delta+g_b+n)-(g_b+n-g_a))))\n",
    "\n",
    "# Solving the emission equation (max_emis) for k\n",
    "max_emis_k=sm.solve(max_emis,k)\n",
    "max_emis_k\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "The above expression is capital at the peak of emmisions."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 75,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/latex": [
       "$$\\left [ 4.266759550779367\\right ]$$"
      ],
      "text/plain": [
       "[4.266759550779367]"
      ]
     },
     "execution_count": 75,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Converting our maximum emissions sympy function (max_emis_func) into a lambda function, making it possible to\n",
    "# calculate a numerical value solution.\n",
    "max_emis_func = sm.lambdify((s,g_b,n,delta,alpha,theta,g_a),max_emis_k)\n",
    "\n",
    "# Adding numerical values to our parameters\n",
    "max_emis_func(0.25,0.015,0.01,0.035,0.25,0.05,0.03)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "At the peak of emmisions capital is equal to 4.27."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### 2.2 Environmental Kuznets Curve"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We would like to illustrate how the Environmental Kuznetz Curve is derived. First we define functions to use in the plot  "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 85,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Running python file defining variables to remove the previously set parameter values\n",
    "exec(open(\"Def_values.py\").read())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 86,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Calculate the change of emissions for different k values  \n",
    "def ekc(k, theta,s):\n",
    "    return (alpha*s*(1-theta)*k**(alpha-1))\n",
    "\n",
    "# Calculate the turning point of the emissions\n",
    "def turning_point(alpha):\n",
    "    return alpha*(delta+g_b+n)-(g_b+n-g_a)\n",
    "\n",
    "# Calculate the steady state value of \n",
    "def steady_state(alpha):\n",
    "    return alpha*(delta+g_b+n)\n",
    "    \n",
    "def find_nearest(array, values):\n",
    "    indices = np.abs(np.subtract.outer(array, values)).argmin(0)\n",
    "    return indices\n",
    "    "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 87,
   "metadata": {},
   "outputs": [],
   "source": [
    "# Defining the k values of the function\n",
    "x_vec2 = np.linspace(0.01,200,1000)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 88,
   "metadata": {},
   "outputs": [],
   "source": [
    "def ekc_diagram(theta,s):\n",
    "    fig = plt.figure(figsize=(7,4)) # create the figure\n",
    "    plt.xlabel('k')\n",
    "    ekc_calc=ekc(x_vec2, theta,s)\n",
    "    steady_state_val=steady_state(alpha)\n",
    "    turning_point_val=turning_point(alpha)\n",
    "    plt.title('Generating Environmental Kuznets Curve')\n",
    "    ax = fig.add_subplot(1,1,1) # create a 3d axis in the figure \n",
    "    plt.axhline(y=steady_state_val, color='r', linestyle='-', label=\"$\\\\alpha \\cdot(\\delta+g_B+n)$\")\n",
    "    plt.axhline(y=turning_point_val, color='y', linestyle='-', label=\"$\\\\alpha \\cdot(\\delta+g_B+n)-(g_b+n-g_a)$\")\n",
    "    ax.plot(ekc_calc, label='$\\\\alpha \\cdot s \\cdot(1-\\\\theta)\\cdot k^{\\\\alpha-1}$'); # create surface plot in the axis\n",
    "    steady_state_x=find_nearest(ekc_calc,steady_state_val)\n",
    "    turning_point_x=find_nearest(ekc_calc,turning_point_val)\n",
    "    ax.plot([steady_state_x], [steady_state_val], 'o', color='k')\n",
    "    ax.plot([turning_point_x], [turning_point_val], 'o', color='k')\n",
    "    ax.annotate('Point B', xy=(steady_state_x, steady_state_val), xytext=(steady_state_x, steady_state_val+0.001),\n",
    "               )\n",
    "    ax.annotate('Point T', xy=(turning_point_x, turning_point_val), xytext=(turning_point_x, turning_point_val+0.001),\n",
    "               )\n",
    "               \n",
    "    \n",
    "    \n",
    "    #idx = np.argwhere(np.diff(np.sign(ekc_calc - steady_state_val))).flatten()\n",
    "    #plt.plot(x_vec2[idx], steady_state_val[idx], 'ro')\n",
    "    #x,y=np.intersect1d([ekc_calc],[turning_point_val],[steady_state_val])\n",
    "    #plt.scatter(y,\"*k\")\n",
    "    ax.set_xlim([0,200]) # fixed x range\n",
    "    ax.set_ylim([0,0.05])\n",
    "    ax.set_yticklabels([])\n",
    "    ax.set_xticklabels([])\n",
    "    plt.legend()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 89,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.jupyter.widget-view+json": {
       "model_id": "7c68d58161604aa790eef63f86225311",
       "version_major": 2,
       "version_minor": 0
      },
      "text/plain": [
       "interactive(children=(FloatSlider(value=0.05, description='$Theta$', max=1.0, min=0.005, step=0.01), FloatSlid…"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "widgets.interact(ekc_diagram,\n",
    "    \n",
    "    theta=widgets.FloatSlider(description=\"$Theta$\", min=0.005, max=1, step=0.01, value=0.05),\n",
    "    s=widgets.FloatSlider(description=\"$s$\", min=0.005, max=1, step=0.01, value=0.25),\n",
    "    \n",
    ");"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Comment on the figure!!!"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.1"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
